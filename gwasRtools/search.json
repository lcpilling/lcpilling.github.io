[{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Luke Pilling. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pilling L (2023). gwasRtools: useful R functions processing GWAS output. R package version 0.1.2, https://github.com/lukepilling/lukesRlib.","code":"@Manual{,   title = {gwasRtools: Some useful R functions for processing GWAS output},   author = {Luke Pilling},   year = {2023},   note = {R package version 0.1.2},   url = {https://github.com/lukepilling/lukesRlib}, }"},{"path":"/index.html","id":"gwasrtools","dir":"","previous_headings":"","what":"Some useful R functions for processing GWAS output","title":"Some useful R functions for processing GWAS output","text":"useful R functions processing GWAS output","code":""},{"path":"/index.html","id":"list-of-functions","dir":"","previous_headings":"","what":"List of functions","title":"Some useful R functions for processing GWAS output","text":"lambda_gc() get_loci() get_nearest_gene()","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Some useful R functions for processing GWAS output","text":"install gwasRtools GitHub use remotes package: remotes::install_github(\"lukepilling/gwasRtools\") update package just run command .","code":""},{"path":"/index.html","id":"lambda_gc","dir":"","previous_headings":"","what":"lambda_gc()","title":"Some useful R functions for processing GWAS output","text":"Estimate inflation test statistics. Lambda GC compares median test statistic expected median test statistic null hypothesis association. well-powered quantitative traits known polygenic inheritance, expect inflation lambda GC, traits expected association, expect lambda GC around 1.","code":"lambda_gc(p_values)"},{"path":"/index.html","id":"get_loci","dir":"","previous_headings":"","what":"get_loci()","title":"Some useful R functions for processing GWAS output","text":"Determine loci GWAS summary statistics file. Use distance lead significant SNP estimate independet loci GWAS summary stats. Uses -log10(p) derived BETA/SE need P input. Example default input (output truncated): Loci numbered. Variants within locus (.e., significant p_threshold less n_bases last significant variant). Lead variant locus highlighted lead==TRUE (.e., smallest p-value variant within locus)","code":"get_loci(   gwas,   snp_col = \"SNP\",   chr_col = \"CHR\",   pos_col = \"BP\",   maf_col = \"MAF\",   beta_col = \"BETA\",   se_col = \"SE\",   n_bases = 5e5,   p_threshold = 5e-8 )  # example using BOLT-LMM output: gwas_loci = get_loci(gwas, maf_col=\"A1FREQ\")  head(gwas_loci, 5) #> # A tibble: 5 × 11 #>    SNP               CHR        BP ALLELE1 ALLELE0 A1FREQ    BETA      SE  P_BOLT_LMM locus lead  #>    <chr>           <dbl>     <dbl> <chr>   <chr>    <dbl>   <dbl>   <dbl>       <dbl> <dbl> <lgl> #>  1 rs3041466           2 142820625 C       CAA      0.492 -0.0177 0.00317 0.000000021     1 TRUE  #>  2 rs5858140           4  49039586 C       CA       0.429 -0.0182 0.00332 0.000000036     2 FALSE #>  3 rs2605231           4  49057424 A       T        0.293 -0.0179 0.00329 0.000000044     2 FALSE #>  4 4:49057608_AT_A     4  49057608 AT      A        0.301 -0.0188 0.00338 0.000000024     2 FALSE #>  5 4:49057930_CT_C     4  49057930 CT      C        0.286 -0.0186 0.00336 0.000000029     2 FALSE  head(gwas_loci |> filter(lead==TRUE), 5) #> # A tibble: 5 × 11 #>    SNP          CHR        BP ALLELE1 ALLELE0 A1FREQ    BETA      SE P_BOLT_LMM locus lead  #>    <chr>      <dbl>     <dbl> <chr>   <chr>    <dbl>   <dbl>   <dbl>      <dbl> <dbl> <lgl> #>  1 rs3041466      2 142820625 C       CAA      0.492 -0.0177 0.00317   2.10e- 8     1 TRUE  #>  2 rs11722559     4  49227587 T       C        0.225 -0.0240 0.00391   7.70e-10     2 TRUE  #>  3 rs4865414      4  52758294 C       T        0.684  0.0200 0.00322   5.10e-10     3 TRUE  #>  4 rs74405522     6 157205286 T       C        0.962  0.0432 0.00788   4.20e- 8     4 TRUE  #>  5 rs55730499     6 161005610 C       T        0.918  0.0378 0.00548   5.80e-12     5 TRUE"},{"path":"/index.html","id":"use-ld-clumping-to-identify-independent-snps-at-the-same-locus","dir":"","previous_headings":"get_loci()","what":"Use LD clumping to identify independent SNPs at the same locus","title":"Some useful R functions for processing GWAS output","text":"Setting option get_ld_indep=TRUE use {ieugwasr} package ld_clump() function run Plink LD clumping. Default use local Plink installation (faster) EUR reference panel. setting option ld_clump_local FALSE use online IEU API. See {ieugwasr} docs details. Default R2 threshold LD pruning 0.001 (modify ld_pruning_r2 option). , locus 2 one “lead” SNP (lowest p-value) ld_clump() identified multiple independent variants region. Note original locus lead columns remain, new column ld_indep added indicating ld_clump() identified lead SNPs. necessarily including original lead especially GWAS SNPs reference panel.","code":"get_loci(   gwas,   snp_col = \"SNP\",   chr_col = \"CHR\",   pos_col = \"BP\",   maf_col = \"MAF\",   beta_col = \"BETA\",   se_col = \"SE\",   n_bases = 5e5,   p_threshold = 5e-8,   get_ld_indep=TRUE )  # example using BOLT-LMM output: gwas_loci = get_loci(gwas, maf_col=\"A1FREQ\", get_ld_indep=TRUE)  head(gwas_loci |> filter(ld_clump==TRUE), 5) #> # A tibble: 5 × 11 #>   SNP           CHR        BP ALLELE1 ALLELE0 A1FREQ    BETA      SE P_BOLT_LMM locus lead  ld_indep #>   <chr>       <dbl>     <dbl> <chr>   <chr>    <dbl>   <dbl>   <dbl>      <dbl> <dbl> <lgl> <lgl> #> 1 rs333957        1 110434791 C       G       0.579   0.0432 0.00708  9.2 e- 10     1 TRUE  TRUE #> 2 rs182541539     2 189399724 C       T       0.993  -0.270  0.0459   1   e-  8     2 FALSE TRUE #> 3 rs10207004      2 190246799 C       T       0.964  -0.356  0.0182   1.20e- 88     2 FALSE TRUE #> 4 rs78842559      2 190396563 G       T       0.977  -0.221  0.0228   3.20e- 23     2 FALSE TRUE #> 5 rs4428180       3 133466374 A       G       0.851  -0.120  0.00965  7.5 e- 38     3 TRUE  TRUE"},{"path":"/index.html","id":"get_nearest_gene","dir":"","previous_headings":"","what":"get_nearest_gene()","title":"Some useful R functions for processing GWAS output","text":"Get nearest gene set variants using GENCODE data. Need provide data.frame variant IDs (e.g., rsids), CHR POS. Defaults , example output: dist positive, variant intergenic, distance closest gene. dist negative, variant within gene, distance start gene. dist NA, variant within n_bases gene GENCODE.","code":"get_nearest_gene(   snps,   snp_col = \"SNP\",   chr_col = \"CHR\",   pos_col = \"BP\",   build   = 37,   n_bases = 1e5 ) #> # A tibble: 3 × 5 #>   SNP          CHR        BP gene        dist #>   <chr>      <dbl>     <dbl> <chr>      <dbl> #> 1 rs55730499     6 161005610 LPA       -53095 #> 3 rs814573      19  45424351 APOC1       1745 #> 3 rs123456      20  98765432 NA            NA"},{"path":"/reference/get_loci.html","id":null,"dir":"Reference","previous_headings":"","what":"Get loci from GWAS file — get_loci","title":"Get loci from GWAS file — get_loci","text":"Use distance lead significant SNP estimate independet loci GWAS summary stats. Uses -log10(p) derived BETA/SE need P input.","code":""},{"path":"/reference/get_loci.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get loci from GWAS file — get_loci","text":"","code":"get_loci(   gwas,   snp_col = \"SNP\",   chr_col = \"CHR\",   pos_col = \"BP\",   maf_col = \"MAF\",   beta_col = \"BETA\",   se_col = \"SE\",   stat_col = \"NA\",   p_col = \"NA\",   neglog10p_col = \"NA\",   use_pvalue = FALSE,   n_bases = 5e+05,   p_threshold = 5e-08,   get_ld_indep = FALSE,   ld_pruning_r2 = 0.001,   ld_clump_local = TRUE,   ld_plink_bin = \"plink\",   ld_bfile = \"/indy/data/ld/1kg_v3/EUR\" )"},{"path":"/reference/get_loci.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get loci from GWAS file — get_loci","text":"gwas data.frame. Contains GWAS summary statistics. snp_col string. Default=\"SNP\". RSID/variantID column name. chr_col string. Default=\"CHR\". chromosome column name. pos_col string. Default=\"BP\". base pair/position column name. maf_col string. Default=\"MAF\". MAF/minor-allele-frequency column name. beta_col string. Default=\"BETA\". BETA column name. se_col string. Default=\"SE\". SE column name. stat_col string. Default=\"NA\". test statistic column name. (required providing beta+se, neglog10p) p_col string. Default=\"NA\". p-value column name. (required `use_pvalue==TRUE` .e., using provided p-value, e.g., P_BOLT_LMM) neglog10p_col string. Default=\"NA\". -log10 p-value column name. (required providing beta+se, stat) use_pvalue Logical. Default=FALSE. Use provided p-value (`p_col`) rather computing test statistic? Useful BOLT-LMM output n_bases interger. Default=5e5. distance two significant SNPs, beyond defined separate loci. p_threshold number. Default=5e-8. P-value threshold statistical significance get_ld_indep Logical. Default=FALSE. Use Plink LD clumping identify independent SNPs - see ieugwasr::ld_clump() docs ld_pruning_r2 Numeric. Default=0.001. Pruning threshold LD. ld_clump_local Logical. Default=TRUE. clumping using local installation (rather IEU API) - see ieugwasr::ld_clump() docs ld_plink_bin string. Default=\"plink\". Path Plink v1.90 binary ld_bfile string. Default=\"/indy/data/ld/1kg_v3/EUR\". Path BIM/BED reference panel files","code":""},{"path":"/reference/get_loci.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get loci from GWAS file — get_loci","text":"Returns data frame significant SNPs locus annotation","code":""},{"path":"/reference/get_loci.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Get loci from GWAS file — get_loci","text":"Luke Pilling","code":""},{"path":"/reference/get_loci.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get loci from GWAS file — get_loci","text":"","code":"get_loci(gwas) #> Error in as.data.frame(gwas): object 'gwas' not found"},{"path":"/reference/get_nearest_gene.html","id":null,"dir":"Reference","previous_headings":"","what":"Get nearest gene from a set of variants — get_nearest_gene","title":"Get nearest gene from a set of variants — get_nearest_gene","text":"Use distance variant position get nearest gene. Uses snpsettest function `map_snp_to_gene` identify genes GENCODE databases (https://github.com/HimesGroup/snpsettest).","code":""},{"path":"/reference/get_nearest_gene.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get nearest gene from a set of variants — get_nearest_gene","text":"","code":"get_nearest_gene(   variants,   snp_col = \"SNP\",   chr_col = \"CHR\",   pos_col = \"BP\",   build = 37,   n_bases = 1e+05 )"},{"path":"/reference/get_nearest_gene.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get nearest gene from a set of variants — get_nearest_gene","text":"variants data.frame. Contains variants (e.g., summary statistics). snp_col string. Default=\"SNP\". RSID/variantID column name. chr_col string. Default=\"CHR\". chromosome column name. pos_col string. Default=\"BP\". base pair/position column name. build integer. Default=37. Genome build use (can 37 38). n_bases interger. Default=1e5. max distance base-pairs variant gene annotate","code":""},{"path":"/reference/get_nearest_gene.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get nearest gene from a set of variants — get_nearest_gene","text":"Returns data frame variant IDs mapped genes (distance)","code":""},{"path":"/reference/get_nearest_gene.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Get nearest gene from a set of variants — get_nearest_gene","text":"Luke Pilling","code":""},{"path":"/reference/get_nearest_gene.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get nearest gene from a set of variants — get_nearest_gene","text":"","code":"get_nearest_gene(variants) #> Error in dplyr::mutate(gwas, id = !!rlang::sym(snp_col), chr = !!rlang::sym(chr_col),     pos = !!rlang::sym(pos_col), pvalue = !!rlang::sym(p_col)): object 'variants' not found"},{"path":"/reference/lambda_gc.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Lambda GC from p-values — lambda_gc","title":"Estimate Lambda GC from p-values — lambda_gc","text":"Estimate inflation test statistics. Lambda GC compares median test statistic expected median test statistic null hypothesis association. well-powered quantitative traits known polygenic inheritance, expect inflation lambda GC, traits expected association, expect lambda GC around 1. Original function Jing Hua Zhao (https://jinghuazhao.github.io/)","code":""},{"path":"/reference/lambda_gc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Lambda GC from p-values — lambda_gc","text":"","code":"lambda_gc(p)"},{"path":"/reference/lambda_gc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Lambda GC from p-values — lambda_gc","text":"p numeric vector p-values","code":""},{"path":"/reference/lambda_gc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Lambda GC from p-values — lambda_gc","text":"Returns vector","code":""},{"path":"/reference/lambda_gc.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Estimate Lambda GC from p-values — lambda_gc","text":"Jing Hua Zhao","code":""},{"path":"/reference/lambda_gc.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate Lambda GC from p-values — lambda_gc","text":"","code":"lambda_gc(p) #> Error in lambda_gc(p): object 'p' not found"},{"path":"/news/index.html","id":"gwasrtools-012","dir":"Changelog","previous_headings":"","what":"gwasRtools 0.1.2","title":"gwasRtools 0.1.2","text":"Fixes get_loci() niche cases","code":""},{"path":"/news/index.html","id":"gwasrtools-011","dir":"Changelog","previous_headings":"","what":"gwasRtools 0.1.1","title":"gwasRtools 0.1.1","text":"Fix internal -log10p calculation Swap “Depends” “Imports” Add dependency {ieugwasr} Add ld_clump option get_loci() function, get independent SNPs locus Add use_pvalue option get_loci() function","code":""},{"path":"/news/index.html","id":"gwasrtools-010","dir":"Changelog","previous_headings":"","what":"gwasRtools 0.1.0","title":"gwasRtools 0.1.0","text":"Added NEWS.md file track changes package.","code":""}]
