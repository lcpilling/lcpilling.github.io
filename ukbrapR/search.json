[{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Luke Pilling. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pilling L (2023). ukbrapR: R functions use UK Biobank Research Analysis Platform (RAP). https://lukepilling.github.io/ukbrapR, https://github.com/lukepilling/ukbrapR.","code":"@Manual{,   title = {ukbrapR: R functions to use in the UK Biobank Research Analysis Platform (RAP)},   author = {Luke Pilling},   year = {2023},   note = {https://lukepilling.github.io/ukbrapR, https://github.com/lukepilling/ukbrapR}, }"},{"path":"/index.html","id":"ukbrapr","dir":"","previous_headings":"","what":"R functions to use in the UK Biobank Research Analysis Platform (RAP)","title":"R functions to use in the UK Biobank Research Analysis Platform (RAP)","text":"R functions use UK Biobank Research Analysis Platform (RAP).","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"R functions to use in the UK Biobank Research Analysis Platform (RAP)","text":"work DNAnexus (https://ukbiobank.dnanexus.com) approved UK Biobank project. tools, create JupyterLab environment Spark Cluster. Start R session install package. install necessary dependencies interacting Python environment, Apache Spark, Arrow C++ library.","code":"if (!require(remotes)) install.packages(\"remotes\") remotes::install_github(\"lukepilling/ukbrapR\")   # this takes a few minutes to build the dependencies"},{"path":"/index.html","id":"get-phenotypes-on-the-rap","dir":"","previous_headings":"","what":"Get phenotypes on the RAP","title":"R functions to use in the UK Biobank Research Analysis Platform (RAP)","text":"main motivation create wrapper function R extract phenotype variables Spark distributed database functions (like SQL). primary function get_rap_phenos() mostly contains code UK Biobank DNAnexus team https://github.com/UK-Biobank/UKB-RAP-Notebooks/blob/main/NBs_Prelim/105_export_participant_data_to_r.ipynb.","code":"library(ukbrapR)  # get phenotype data (participant ID, sex, and baseline age) df <- get_rap_phenos(c(\"eid\",\"p31\",\"p21003_i0\"))   # takes a few minutes to complete interactions with Apache Spark etc.  # overview of data skimr::skim(df) #> ── Data Summary ──────────────────────── #>                            Values #> Name                       df     #> Number of rows             502364 #> Number of columns          3      #> _______________________           #> Column type frequency:            #>   character                2      #>   numeric                  1      #> ________________________          #> Group variables            None   #>  #> ── Variable type: character ──────────────────────────────────────────────────── #>   skim_variable n_missing complete_rate min max empty n_unique whitespace #> 1 eid                   0             1   7   7     0   502364          0 #> 2 p31                   0             1   4   6     0        2          0 #>  #> ── Variable type: numeric ────────────────────────────────────────────────────── #>   skim_variable n_missing complete_rate mean   sd p0 p25 p50 p75 p100 hist  #> 1 p21003_i0             0             1 56.5 8.09 37  50  58  63   73 ▂▅▆▇▃  # save to file on the RAP worker node write_tsv(df, \"ukb14631.data_output.20231026.txt.gz\")"},{"path":"/index.html","id":"upload-back-to-the-rap","dir":"","previous_headings":"","what":"Upload back to the RAP","title":"R functions to use in the UK Biobank Research Analysis Platform (RAP)","text":"wrapper quickly upload file worker node RAP space.","code":"# uploads to current working directory upload_to_rap(\"ukb14631.data_output.20231026.txt.gz\")  # uploads to directory \"extracts\" upload_to_rap(\"ukb14631.data_output.20231026.txt.gz\", dir=\"extracts/\")"},{"path":"/reference/get_rap_phenos.html","id":null,"dir":"Reference","previous_headings":"","what":"Use R on the UK Biobank RAP (Spark cluster) to get phenotype data — get_rap_phenos","title":"Use R on the UK Biobank RAP (Spark cluster) to get phenotype data — get_rap_phenos","text":"Using Spark node/cluster UK Biobank RAP, run R extract provided set variables. Using code UK Biobank DNAnexus team https://github.com/UK-Biobank/UKB-RAP-Notebooks/blob/main/NBs_Prelim/105_export_participant_data_to_r.ipynb","code":""},{"path":"/reference/get_rap_phenos.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use R on the UK Biobank RAP (Spark cluster) to get phenotype data — get_rap_phenos","text":"","code":"get_rap_phenos(names, record = NULL, verbose = FALSE)"},{"path":"/reference/get_rap_phenos.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use R on the UK Biobank RAP (Spark cluster) to get phenotype data — get_rap_phenos","text":"names string vector strings. variable name(s) required. e.g., c(\"eid\",\"p31\",\"p21003_i0\") (character) record string. `dnanexus_link` file descriptor .dataset use. Default (left NULL) use recent update (character) verbose Logical. verbose, default=FALSE","code":""},{"path":"/reference/get_rap_phenos.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use R on the UK Biobank RAP (Spark cluster) to get phenotype data — get_rap_phenos","text":"Returns data.frame (participant data requested variables)","code":""},{"path":"/reference/get_rap_phenos.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Use R on the UK Biobank RAP (Spark cluster) to get phenotype data — get_rap_phenos","text":"Luke Pilling","code":""},{"path":"/reference/get_rap_phenos.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Use R on the UK Biobank RAP (Spark cluster) to get phenotype data — get_rap_phenos","text":"","code":"# get phenotype data df <- get_rap_phenos(c(\"eid\",\"p31\",\"p21003_i0\")) #> Getting data for  3  phenotypes #> *** If asked about creating a python environment, choose 'no' **** #> Error: python38.dll - The specified module could not be found.   # save to file on the RAP worker node write_tsv(df, \"ukb14631.data_output.20231026.txt.gz\") #> Error in write_tsv(df, \"ukb14631.data_output.20231026.txt.gz\"): could not find function \"write_tsv\"  # upload data to RAP storage ukbrapR::upload_to_rap(file=\"ukb14631.data_output.20231026.txt.gz\", dir=\"\") #> Error in ukbrapR::upload_to_rap(file = \"ukb14631.data_output.20231026.txt.gz\",     dir = \"\"): `file` not found"},{"path":"/reference/upload_to_rap.html","id":null,"dir":"Reference","previous_headings":"","what":"Use R to upload a file to the UK Biobank RAP — upload_to_rap","title":"Use R to upload a file to the UK Biobank RAP — upload_to_rap","text":"Use R upload file UK Biobank RAP (really just wrapper `dx upload`)","code":""},{"path":"/reference/upload_to_rap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use R to upload a file to the UK Biobank RAP — upload_to_rap","text":"","code":"upload_to_rap(file, dir = \"FALSE\", verbose = FALSE)"},{"path":"/reference/upload_to_rap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use R to upload a file to the UK Biobank RAP — upload_to_rap","text":"file string. Filename file uploaded (character) dir string. Target directory RAP space. blank, current working directory (character) verbose Logical. verbose, default=FALSE","code":""},{"path":"/reference/upload_to_rap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use R to upload a file to the UK Biobank RAP — upload_to_rap","text":"NA","code":""},{"path":"/reference/upload_to_rap.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Use R to upload a file to the UK Biobank RAP — upload_to_rap","text":"Luke Pilling","code":""},{"path":"/reference/upload_to_rap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Use R to upload a file to the UK Biobank RAP — upload_to_rap","text":"","code":"# upload file to RAP storage ukbrapR::upload_to_rap(file=\"ukb14631.data_output.20231026.txt.gz\", dir=\"extracts/\") #> Error in ukbrapR::upload_to_rap(file = \"ukb14631.data_output.20231026.txt.gz\",     dir = \"extracts/\"): `file` not found"}]
